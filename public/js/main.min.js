document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelectorAll(".anchor");e&&e.length>0&&e.forEach(e=>{e.addEventListener("click",(function(e){e.preventDefault(),window.location.hash&&document.querySelector(window.location.hash).scrollIntoView({behavior:"smooth"})}))})});let selection={start:null,end:null,active:!1,clickCount:0};const setCellFocus=(e,t)=>{t.querySelectorAll("td, th").forEach(e=>e.classList.remove("focused")),e.classList.add("focused")},setEditableCellEvent=(e,t)=>{e.addEventListener("click",()=>{if(selection.active)setCellFocus(e,t),makeCellEditable(e);else if("TD"===e.tagName){const n=+e.dataset.row,l=+e.dataset.column;switch(selection.clickCount){case 0:selection.start={rowIndex:n,columnIndex:l},selection.clickCount+=1;break;case 1:selection.start.rowIndex!==+e.dataset.row||selection.start.columnIndex!==+e.dataset.column?(selection.clickCount+=1,t.querySelectorAll("td").forEach(e=>e.style.backgroundColor=""),selection.end={rowIndex:n,columnIndex:l},joinCells(t)):alert("Выделите вторую ячейку для объединения")}console.log(selection)}})},updateSelectionHandler=(e,t)=>{if("TD"!==t.tagName)return;const n=+t.dataset.row,l=+t.dataset.column;if(selection.end={rowIndex:n,columnIndex:l},e.querySelectorAll("td").forEach(e=>e.style.backgroundColor=""),!selection.start||!selection.end||selection.clickCount>1)return;const o=Math.min(selection.start.rowIndex,selection.end.rowIndex),c=Math.max(selection.start.rowIndex,selection.end.rowIndex),r=Math.min(selection.start.columnIndex,selection.end.columnIndex),a=Math.max(selection.start.columnIndex,selection.end.columnIndex);for(let t=o;t<=c;t++)for(let n=r;n<=a;n++){const l=e.querySelector(`td[data-row="${t}"][data-column="${n}"]`);l&&(l.style.backgroundColor="red")}},joinCells=e=>{const t=Math.min(selection.start.rowIndex,selection.end.rowIndex),n=Math.max(selection.start.rowIndex,selection.end.rowIndex),l=Math.min(selection.start.columnIndex,selection.end.columnIndex),o=Math.max(selection.start.columnIndex,selection.end.columnIndex);console.log(selection);for(let c=t;c<=n;c++)for(let r=l;r<=o;r++){const a=e.querySelector(`td[data-row="${c}"][data-column="${r}"]`);r>l?a.remove():a.setAttribute("colspan",o),c>t?a.remove():a.setAttribute("rowspan",n)}},createTable=(e,t,n,l,o)=>{const c=+t.value,r=+n.value,a=document.createElement("table"),d=document.createElement("thead"),s=document.createElement("tr"),i=document.createElement("tbody");if(isNaN(c)||isNaN(r)||c<1||r<1)alert("Введите правильное количество строк и столбцов от 1");else{e.innerHTML="";for(let t=0;t<r;t++){const n=document.createElement("th");n.textContent="Заголовок "+(t+1),s.append(n),setEditableCellEvent(n,e)}d.append(s),a.append(d);for(let t=0;t<c-1;t++){const n=document.createElement("tr");for(let l=0;l<r;l++){const o=document.createElement("td");0===t&&0===l&&setCellFocus(o,e),o.textContent=`Строка ${t+1}, Ячейка ${l+1}`,o.dataset.row=t.toString(),o.dataset.column=l.toString(),n.append(o),setEditableCellEvent(o,e),o.addEventListener("mouseenter",t=>updateSelectionHandler(e,t.target))}i.append(n)}a.append(i),e.append(a),l.setAttribute("hidden",!0),o.removeAttribute("hidden")}},makeCellEditable=e=>{const t=e.innerHTML;e.innerHTML=`<input type="text" value="${t}" style="width: 100%;">`;const n=e.querySelector("input");n.focus(),n.addEventListener("blur",()=>{e.innerHTML=n.value}),n.addEventListener("keypress",e=>{"Enter"===e.key&&n.blur()})},createRowHandler=e=>{const t=e.querySelector(".focused");if(t){const n=t.closest("tr"),l=document.createElement("tr");[...n.children].forEach(()=>{const t=document.createElement("td");setEditableCellEvent(t,e),l.append(t)}),n.insertAdjacentElement("afterend",l)}},createColumnHandler=e=>{const t=e.querySelector(".focused").cellIndex;e.querySelectorAll("tr").forEach(n=>{const l=n.querySelectorAll("td, th")[t],o="TD"===l.tagName?document.createElement("td"):document.createElement("th");setEditableCellEvent(o,e),l.insertAdjacentElement("afterend",o)})},resetSelection=()=>{selection={start:null,end:null,active:!1,clickCount:0}};document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".table__wrapper");let t=null;const n=document.querySelector(".table__create"),l=document.querySelector(".table__panel"),o=n.querySelector(".table__num-rows"),c=n.querySelector(".table__num-columns"),r=n.querySelector(".js-create-table"),a=l.querySelector(".js-create-row"),d=l.querySelector(".js-create-column");l.querySelector(".js-join-cells");r.addEventListener("click",()=>{createTable(e,o,c,n,l),t=e.querySelector(".table__wrapper table"),a.addEventListener("click",e=>createRowHandler(t)),d.addEventListener("click",e=>createColumnHandler(t))})});
//# sourceMappingURL=maps/main.min.js.map
