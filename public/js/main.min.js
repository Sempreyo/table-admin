document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelectorAll(".anchor");e&&e.length>0&&e.forEach(e=>{e.addEventListener("click",(function(e){e.preventDefault(),window.location.hash&&document.querySelector(window.location.hash).scrollIntoView({behavior:"smooth"})}))})});let selection={start:null,hovered:null,end:null,active:!1,clickCount:0};const setCellFocus=(e,t)=>{t.querySelectorAll("td, th").forEach(e=>e.classList.remove("focused")),e.classList.add("focused")},setEditableCellEvent=(e,t)=>{e.addEventListener("click",()=>{if(selection.active){if("TD"===e.tagName){const n=+e.dataset.row,o=+e.dataset.column;switch(selection.clickCount){case 0:selection.start={rowIndex:n,columnIndex:o},selection.clickCount+=1;break;case 1:selection.start.rowIndex!==+e.dataset.row||selection.start.columnIndex!==+e.dataset.column?(selection.clickCount+=1,t.querySelectorAll("td").forEach(e=>e.style.backgroundColor=""),selection.end={rowIndex:n,columnIndex:o},joinCells(t)):alert("Выделите вторую ячейку для объединения")}}}else setCellFocus(e,t),makeCellEditable(e)})},updateSelectionHandler=(e,t)=>{if("TD"!==t.tagName)return;const n=+t.dataset.row,o=+t.dataset.column;if(selection.hovered={rowIndex:n,columnIndex:o},e.querySelectorAll("td").forEach(e=>e.style.backgroundColor=""),!selection.start||!selection.hovered||selection.clickCount>1)return;const l=Math.min(selection.start.rowIndex,selection.hovered.rowIndex),c=Math.max(selection.start.rowIndex,selection.hovered.rowIndex),r=Math.min(selection.start.columnIndex,selection.hovered.columnIndex),a=Math.max(selection.start.columnIndex,selection.hovered.columnIndex);for(let t=l;t<=c;t++)for(let n=r;n<=a;n++){const o=e.querySelector(`td[data-row="${t}"][data-column="${n}"]`);o&&(o.style.backgroundColor="#a2ddfa")}},joinCells=e=>{const t=Math.min(selection.start.rowIndex,selection.end.rowIndex),n=Math.max(selection.start.rowIndex,selection.end.rowIndex),o=Math.min(selection.start.columnIndex,selection.end.columnIndex),l=Math.max(selection.start.columnIndex,selection.end.columnIndex),c=e.querySelectorAll("tbody tr"),r=c[t].cells[o],a=r.textContent;for(let e=t;e<=n;e++)for(let n=o;n<=l;n++){if(e===t&&n===o)continue;const l=c[e].cells[n];l.setAttribute("hidden","true"),l.setAttribute("data-merged","true"),l.setAttribute("data-merged-with",`${t}, ${o}`)}r.rowSpan=n-t+1,r.colSpan=l-o+1,r.textContent=a,r.setAttribute("data-merged-main","true"),resetSelection()},createTable=(e,t,n,o,l)=>{const c=+t.value,r=+n.value,a=document.createElement("table"),d=document.createElement("thead"),s=document.createElement("tr"),i=document.createElement("tbody");if(isNaN(c)||isNaN(r)||c<1||r<1)alert("Введите правильное количество строк и столбцов от 1");else{e.innerHTML="";for(let t=0;t<r;t++){const n=document.createElement("th");n.textContent="Заголовок "+(t+1),n.dataset.row="0",n.dataset.column=t.toString(),s.append(n),setEditableCellEvent(n,e),n.addEventListener("mouseenter",t=>updateSelectionHandler(e,t.target))}d.append(s),a.append(d);for(let t=0;t<c-1;t++){const n=document.createElement("tr");for(let o=0;o<r;o++){const l=document.createElement("td");0===t&&0===o&&setCellFocus(l,e),l.textContent=`Строка ${t+1}, Ячейка ${o+1}`,l.dataset.row=t.toString(),l.dataset.column=o.toString(),n.append(l),setEditableCellEvent(l,e),l.addEventListener("mouseenter",t=>updateSelectionHandler(e,t.target))}i.append(n)}a.append(i),e.append(a),o.setAttribute("hidden",!0),l.removeAttribute("hidden")}},makeCellEditable=e=>{const t=e.textContent;e.textContent="";const n=document.createElement("input");n.type="text",n.value=t,e.append(n),n.focus();const o=()=>{e.textContent=n.value};n.addEventListener("blur",o),n.addEventListener("click",e=>{e.stopPropagation()}),n.addEventListener("keydown",e=>{"Enter"===e.key&&o()})},createRowHandler=e=>{const t=e.querySelector(".focused");if(t){const n=t.closest("tr"),o=document.createElement("tr");[...n.children].forEach(()=>{const t=document.createElement("td");setEditableCellEvent(t,e),o.append(t)}),n.insertAdjacentElement("afterend",o)}},createColumnHandler=e=>{const t=e.querySelector(".focused").cellIndex;e.querySelectorAll("tr").forEach(n=>{const o=n.querySelectorAll("td, th")[t],l="TD"===o.tagName?document.createElement("td"):document.createElement("th");setEditableCellEvent(l,e),o.insertAdjacentElement("afterend",l)})},resetSelection=()=>{selection={start:null,hovered:null,end:null,active:!1,clickCount:0}};document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".table__wrapper");let t=null;const n=document.querySelector(".table__create"),o=document.querySelector(".table__panel"),l=n.querySelector(".table__num-rows"),c=n.querySelector(".table__num-columns"),r=n.querySelector(".js-create-table"),a=o.querySelector(".js-create-row"),d=o.querySelector(".js-create-column"),s=o.querySelector(".js-join-cells");r.addEventListener("click",()=>{createTable(e,l,c,n,o),t=e.querySelector(".table__wrapper table")}),a.addEventListener("click",()=>createRowHandler(t)),d.addEventListener("click",()=>createColumnHandler(t)),s.addEventListener("click",()=>{selection.active=!0})});
//# sourceMappingURL=maps/main.min.js.map
