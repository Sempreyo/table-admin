{"version":3,"sources":["main.js"],"names":["document","addEventListener","anchors","querySelectorAll","length","forEach","anchor","e","preventDefault","window","location","hash","querySelector","scrollIntoView","behavior","selection","start","end","active","clickCount","setCellFocus","td","parent","cell","classList","remove","add","setEditableCellEvent","makeCellEditable","tagName","rowIndex","dataset","row","columnIndex","column","style","backgroundColor","joinCells","alert","console","log","updateSelectionHandler","table","startRow","Math","min","endRow","max","startColumn","endColumn","setAttribute","createTable","rowsInput","columnsInput","menuCreate","menuPanel","rows","value","columns","createElement","thead","headerRow","tbody","isNaN","innerHTML","th","textContent","append","tr","toString","target","removeAttribute","currentText","input","focus","key","blur","createRowHandler","focusedCell","closest","newRow","children","insertAdjacentElement","createColumnHandler","focusedCellIndex","cellIndex","cellSelected","newCell","resetSelection","container","menuCreateTable","createButton","addRowButton","addColumnButton"],"mappings":"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","file":"../main.min.js","sourcesContent":["/* Common */\r\ndocument.addEventListener(\"DOMContentLoaded\", () => {\r\n\tconst anchors = document.querySelectorAll('.anchor');\r\n\r\n\tif (anchors && anchors.length > 0) {\r\n\t\tanchors.forEach(anchor => {\r\n\t\t\tanchor.addEventListener('click', function (e) {\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\tif (window.location.hash) {\r\n\t\t\t\t\tdocument.querySelector(window.location.hash).scrollIntoView({\r\n\t\t\t\t\t\tbehavior: 'smooth'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n});\r\nlet selection = {\r\n\tstart: null,\r\n\tend: null,\r\n\tactive: false,\r\n\tclickCount: 0\r\n};\r\n\r\nconst setCellFocus = (td, parent) => {\r\n\tconst cells = parent.querySelectorAll(\"td, th\");\r\n\r\n\tcells.forEach(cell => cell.classList.remove(\"focused\"));\r\n\ttd.classList.add(\"focused\");\r\n}\r\n\r\n// Событие редактирования ячейки\r\nconst setEditableCellEvent = (cell, parent) => {\r\n\tcell.addEventListener(\"click\", () => {\r\n\t\tif (selection.active) { // В обычном режиме\r\n\t\t\tsetCellFocus(cell, parent);\r\n\t\t\tmakeCellEditable(cell);\r\n\t\t} else if (cell.tagName === \"TD\") { // В режиме объединения/разделения ячеек\r\n\t\t\tconst rowIndex = +cell.dataset.row;\r\n\t\t\tconst columnIndex = +cell.dataset.column;\r\n\r\n\t\t\tswitch (selection.clickCount) {\r\n\t\t\t\tcase 0:\r\n\t\t\t\t\tselection.start = {rowIndex, columnIndex};\r\n\t\t\t\t\tselection.clickCount += 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\tif (selection.start.rowIndex !== +cell.dataset.row ||\r\n\t\t\t\t\t\tselection.start.columnIndex !== +cell.dataset.column\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tselection.clickCount += 1;\r\n\t\t\t\t\t\tparent.querySelectorAll(\"td\").forEach(td => td.style.backgroundColor = \"\");\r\n\t\t\t\t\t\tselection.end = {rowIndex, columnIndex};\r\n\t\t\t\t\t\tjoinCells(parent);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\talert(\"Выделите вторую ячейку для объединения\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tconsole.log(selection);\r\n\r\n\t\t\t//resetSelection();\r\n\t\t}\r\n\t});\r\n}\r\n\r\n// Выделение ячеек при объединении/разделении ячеек\r\nconst updateSelectionHandler = (table, td) => {\r\n\tif (td.tagName !== \"TD\") return;\r\n\r\n\tconst rowIndex = +td.dataset.row;\r\n\tconst columnIndex = +td.dataset.column;\r\n\r\n\tselection.end = {rowIndex, columnIndex};\r\n\r\n\ttable.querySelectorAll(\"td\").forEach(td => td.style.backgroundColor = \"\");\r\n\r\n\tif (!selection.start || !selection.end || selection.clickCount > 1) return;\r\n\r\n\tconst startRow = Math.min(selection.start.rowIndex, selection.end.rowIndex);\r\n\tconst endRow = Math.max(selection.start.rowIndex, selection.end.rowIndex);\r\n\tconst startColumn = Math.min(selection.start.columnIndex, selection.end.columnIndex);\r\n\tconst endColumn = Math.max(selection.start.columnIndex, selection.end.columnIndex);\r\n\t\r\n\tfor (let row = startRow; row <= endRow; row++) {\r\n\t\tfor (let column = startColumn; column <= endColumn; column++) {\r\n\t\t\tconst td = table.querySelector(`td[data-row=\"${row}\"][data-column=\"${column}\"]`);\r\n\r\n\t\t\tif (td) {\r\n\t\t\t\ttd.style.backgroundColor = \"red\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// Объединение ячеек\r\nconst joinCells = (table) => {\r\n\tconst startRow = Math.min(selection.start.rowIndex, selection.end.rowIndex);\r\n\tconst endRow = Math.max(selection.start.rowIndex, selection.end.rowIndex);\r\n\tconst startColumn = Math.min(selection.start.columnIndex, selection.end.columnIndex);\r\n\tconst endColumn = Math.max(selection.start.columnIndex, selection.end.columnIndex);\r\n\r\n\tconsole.log(selection);\r\n\t\r\n\tfor (let row = startRow; row <= endRow; row++) {\r\n\t\tfor (let column = startColumn; column <= endColumn; column++) {\r\n\t\t\tconst td = table.querySelector(`td[data-row=\"${row}\"][data-column=\"${column}\"]`);\r\n\r\n\t\t\tif (column > startColumn) {\r\n\t\t\t\ttd.remove();\r\n\t\t\t} else {\r\n\t\t\t\ttd.setAttribute(\"colspan\", endColumn);\r\n\t\t\t}\r\n\r\n\t\t\tif (row > startRow) {\r\n\t\t\t\ttd.remove();\r\n\t\t\t} else {\r\n\t\t\t\ttd.setAttribute(\"rowspan\", endRow);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst createTable = (parent, rowsInput, columnsInput, menuCreate, menuPanel) => {\r\n\tconst rows = +rowsInput.value;\r\n\tconst columns = +columnsInput.value;\r\n\tconst table = document.createElement(\"table\"); // Элемент таблицы\r\n\tconst thead = document.createElement(\"thead\"); // Заголовок таблицы\r\n\tconst headerRow = document.createElement(\"tr\"); // Строка для заголовка таблицы\r\n\tconst tbody = document.createElement(\"tbody\"); // Тело таблицы\r\n\r\n\tif (isNaN(rows) || isNaN(columns) || rows < 1 || columns < 1) {\r\n\t\talert(\"Введите правильное количество строк и столбцов от 1\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tparent.innerHTML = \"\";\r\n\r\n\t// Создание заголовка таблицы thead\r\n\tfor (let cell = 0; cell < columns; cell++) {\r\n\t\tconst th = document.createElement(\"th\");\r\n\r\n\t\tth.textContent = `Заголовок ${cell+1}`;\r\n\t\t//th.addEventListener(\"click\", sortTable(i));\r\n\t\theaderRow.append(th);\r\n\r\n\t\tsetEditableCellEvent(th, parent);\r\n\t}\r\n\r\n\tthead.append(headerRow);\r\n\ttable.append(thead);\r\n\r\n\t// Создание тела таблицы tbody\r\n\tfor (let row = 0; row < rows - 1; row++) {\r\n\t\tconst tr = document.createElement(\"tr\");\r\n\r\n\t\tfor (let cell = 0; cell < columns; cell++) {\r\n\t\t\tconst td = document.createElement(\"td\");\r\n\r\n\t\t\t// Добавляем фокус первой ячейке в первой строке\r\n\t\t\tif (row === 0 && cell === 0) {\r\n\t\t\t\tsetCellFocus(td, parent);\r\n\t\t\t}\r\n\r\n\t\t\ttd.textContent = `Строка ${row+1}, Ячейка ${cell+1}`;\r\n\t\t\ttd.dataset.row = row.toString();\r\n\t\t\ttd.dataset.column = cell.toString();\r\n\t\t\ttr.append(td);\r\n\r\n\t\t\tsetEditableCellEvent(td, parent);\r\n\r\n\t\t\ttd.addEventListener(\"mouseenter\", (e) => updateSelectionHandler(parent, e.target));\r\n\t\t}\r\n\r\n\t\ttbody.append(tr);\r\n\t}\r\n\r\n\ttable.append(tbody);\r\n\tparent.append(table);\r\n\r\n\tmenuCreate.setAttribute(\"hidden\", true);\r\n\tmenuPanel.removeAttribute(\"hidden\");\r\n\r\n\t// Создание событий\r\n\t/*const newTable = parent.querySelector(\"table\");\r\n\r\n\tnewTable.addEventListener(\"click\", (e) => {\r\n\r\n\t});*/\r\n}\r\n\r\nconst makeCellEditable = (td) => {\r\n\tconst currentText = td.innerHTML;\r\n\r\n\ttd.innerHTML = `<input type=\"text\" value=\"${currentText}\" style=\"width: 100%;\">`;\r\n\r\n\tconst input = td.querySelector(\"input\");\r\n\tinput.focus();\r\n\r\n\tinput.addEventListener(\"blur\", () => {\r\n\t\ttd.innerHTML = input.value;\r\n\t});\r\n\r\n\tinput.addEventListener(\"keypress\", (e) => {\r\n\t\tif (e.key === \"Enter\") {\r\n\t\t\tinput.blur();\r\n\t\t}\r\n\t});\r\n}\r\n\r\nconst createRowHandler = (table) => {\r\n\tconst focusedCell = table.querySelector(\".focused\");\r\n\r\n\tif (focusedCell) {\r\n\t\tconst row = focusedCell.closest(\"tr\");\r\n\t\tconst newRow = document.createElement(\"tr\");\r\n\r\n\t\t[...row.children].forEach(() => {\r\n\t\t\tconst td = document.createElement(\"td\");\r\n\r\n\t\t\tsetEditableCellEvent(td, table);\r\n\r\n\t\t\tnewRow.append(td);\r\n\t\t})\r\n\r\n\t\trow.insertAdjacentElement(\"afterend\", newRow);\r\n\t}\r\n}\r\n\r\nconst createColumnHandler = (table) => {\r\n\tconst focusedCellIndex = table.querySelector(\".focused\").cellIndex;\r\n\r\n\ttable.querySelectorAll(\"tr\").forEach(tr => {\r\n\t\tconst cellSelected = tr.querySelectorAll(\"td, th\")[focusedCellIndex];\r\n\t\tconst newCell = cellSelected.tagName === \"TD\" ?\r\n\t\t\tdocument.createElement(\"td\") :\r\n\t\t\tdocument.createElement(\"th\");\r\n\r\n\t\tsetEditableCellEvent(newCell, table);\r\n\r\n\t\tcellSelected.insertAdjacentElement(\"afterend\", newCell);\r\n\t});\r\n}\r\n\r\nconst resetSelection = () => {\r\n\tselection = {\r\n\t\tstart: null,\r\n\t\tend: null,\r\n\t\tactive: false,\r\n\t\tclickCount: 0\r\n\t}\r\n}\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", () => {\r\n\tconst container = document.querySelector(\".table__wrapper\");\r\n\tlet table = null;\r\n\tconst menuCreateTable = document.querySelector(\".table__create\");\r\n\tconst menuPanel = document.querySelector(\".table__panel\");\r\n\tconst rowsInput = menuCreateTable.querySelector(\".table__num-rows\");\r\n\tconst columnsInput = menuCreateTable.querySelector(\".table__num-columns\");\r\n\tconst createButton = menuCreateTable.querySelector(\".js-create-table\");\r\n\tconst addRowButton = menuPanel.querySelector(\".js-create-row\");\r\n\tconst addColumnButton = menuPanel.querySelector(\".js-create-column\");\r\n\tconst joinCellsButton = menuPanel.querySelector(\".js-join-cells\");\r\n\r\n\tcreateButton.addEventListener(\"click\", () => {\r\n\t\tcreateTable(container, rowsInput, columnsInput, menuCreateTable, menuPanel);\r\n\t\ttable = container.querySelector(\".table__wrapper table\");\r\n\r\n\t\taddRowButton.addEventListener(\"click\", (e) => createRowHandler(table));\r\n\t\taddColumnButton.addEventListener(\"click\", (e) => createColumnHandler(table));\r\n\t});\r\n});"]}